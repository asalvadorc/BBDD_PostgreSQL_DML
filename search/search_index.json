{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Bases de Dades","title":"Bases de Dades"},{"location":"#bases-de-dades","text":"","title":"Bases de Dades"},{"location":"1_introducci/","text":"1. Introducci\u00f3 La sent\u00e8ncia SELECT (Data Query Language) ens permetia consultar la informaci\u00f3 ja introdu\u00efda. Les sent\u00e8ncies de DDL (Data Definition Language) ens permeten crear (o modificar o esborrar) les estructures: taules, \u00edndex, o altres objectes. Les sent\u00e8ncies de DML (Data Manipulation Language) s\u00f3n aquelles que ens han de permetre alterar les dades, \u00e9s a dir, l'estructura de les taules quedar\u00e0 intancta, i nom\u00e9s es modificar\u00e0 el seu contingut: INSERT , per a introduir files noves a la taula. DELETE , per a esborrar files senceres de la taula. UPDATE , per a modificar el contigut d'una o m\u00e9s files ja existents. Durant tota aquesta part de SQL farem consultes per a modificar les dades de les taules. No ens conv\u00e9 en absolut treballar sobre la Base de Dades geo ni sobre factura , ja que el que far\u00edem seria \"boicotejar-nos\" entre nosaltres. Treballarem amb dues Bases de Dades noves: proves (connectant-nos com l'usuari proves ): servir\u00e0 per a fer proves, com el seu propi nom indica. Tots els exemples els farem en aquesta BD. f_grup_9999x , on grup \u00e9s el codi del vostre grup (p.ex 1cfsg, 1cfsj, 1cfsl...), 9999 seran les 4 \u00faltimes xifres del vostre DNI, i x \u00e9s la lletra del vostre NIF. \u00c9s a dir, tindreu una Base de Dades per a cadasc\u00fa de vosaltres, i un usuari amb el mateix nom. \u00c9s on haureu de treballar els exercicis. Us recomane vivament que us creeu una altra connexi\u00f3 per a cadascuna de les Bases de Dades anteriors. D'aquesta manera, segurament en tindreu quatre connexions: la de geo , la de factura , la de proves i la de f_grup_9999x (substituint per les dades del vostre grup i NIF) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"1. Introducci\u00f3"},{"location":"1_introducci/#1-introduccio","text":"La sent\u00e8ncia SELECT (Data Query Language) ens permetia consultar la informaci\u00f3 ja introdu\u00efda. Les sent\u00e8ncies de DDL (Data Definition Language) ens permeten crear (o modificar o esborrar) les estructures: taules, \u00edndex, o altres objectes. Les sent\u00e8ncies de DML (Data Manipulation Language) s\u00f3n aquelles que ens han de permetre alterar les dades, \u00e9s a dir, l'estructura de les taules quedar\u00e0 intancta, i nom\u00e9s es modificar\u00e0 el seu contingut: INSERT , per a introduir files noves a la taula. DELETE , per a esborrar files senceres de la taula. UPDATE , per a modificar el contigut d'una o m\u00e9s files ja existents. Durant tota aquesta part de SQL farem consultes per a modificar les dades de les taules. No ens conv\u00e9 en absolut treballar sobre la Base de Dades geo ni sobre factura , ja que el que far\u00edem seria \"boicotejar-nos\" entre nosaltres. Treballarem amb dues Bases de Dades noves: proves (connectant-nos com l'usuari proves ): servir\u00e0 per a fer proves, com el seu propi nom indica. Tots els exemples els farem en aquesta BD. f_grup_9999x , on grup \u00e9s el codi del vostre grup (p.ex 1cfsg, 1cfsj, 1cfsl...), 9999 seran les 4 \u00faltimes xifres del vostre DNI, i x \u00e9s la lletra del vostre NIF. \u00c9s a dir, tindreu una Base de Dades per a cadasc\u00fa de vosaltres, i un usuari amb el mateix nom. \u00c9s on haureu de treballar els exercicis. Us recomane vivament que us creeu una altra connexi\u00f3 per a cadascuna de les Bases de Dades anteriors. D'aquesta manera, segurament en tindreu quatre connexions: la de geo , la de factura , la de proves i la de f_grup_9999x (substituint per les dades del vostre grup i NIF) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"1. Introducci\u00f3"},{"location":"2_consultes_dactualitzaci/","text":"2. Consultes d'actualitzaci\u00f3 (DML) 2.1 INSERT Servir\u00e0 per a introduir noves files en una determinada taula. Hi ha dues variants d'aquesta sent\u00e8ncia. La primera servir\u00e0 per a introduir noves files proporcionant-li les dades, \u00e9s a dir, indicant expressament els nous valors dels camps. L'altra podria servir per a introduir noves files de forma m\u00e9s massiva, agafant les dades de les taules ja existents per mig d'una sent\u00e8ncia SELECT. Sintaxi per a inserci\u00f3 amb valors INSERT INTO taula [ (camp1 [,camp2 [,...]]) ] VALUES (valor1 [,valor2 [,...]]) [,(...)] Com es pot comprovar d'aquesta manera s'introduir\u00e0 una fila nova, i es proporcionen les dades directament, com a constants. Opcionalment podem introduir els valors per a una segona fila o quantes es vulguen, sempre posant les dades de cada fila entre par\u00e8ntesis, i si hi ha m\u00e9s d'una fila, separats per comes. \u00c9s opcional posar la llista de camps de la taula. Si no es posen, s'haur\u00e0 de posar un valor per a cada camp de la taula, i en el mateix ordre com estan definits en la taula. Si posem expressament els camps de la taula, els podrem posar amb l'ordre que vulguem, i no caldr\u00e0 posar-los tots. Els camps no especificats quedaran amb el valor nul (a no ser que tinguen un valor predeterminat, un valor per defecte). Per tant, haurem de posar obligat\u00f2riament tots els camps definits com a no nuls (inclosa la clau principal). Per a posar el valor nul a un camp posarem expl\u00edcitament NULL . Si tenim definit un camp autonum\u00e8ric (SERIAL) i volem continuar amb el seg\u00fcent de la seq\u00fc\u00e8ncia, no li hem de posar cap valor. Per tant en la sent\u00e8ncia SQL no haur\u00e0 de constar el camp: haurem de posar la llista de camps, i en aquest no ha d'estar el camp autonum\u00e8ric. Veurem despr\u00e9s un exemple per veure-ho m\u00e9s clar. Per contra, podem trencar la seq\u00fc\u00e8ncia posant-li un valor al camp autonum\u00e8ric, per\u00f2 aix\u00f2 no haur\u00e0 modificat la seq\u00fc\u00e8ncia. Si volem modificar-la haur\u00edem de fer-ho amb la sent\u00e8ncia ALTER SEQUENCE . Exemples 1) Introduir un departament nou amb les seg\u00fcents dades: N\u00famero: 6 ; Nom: Personal ; Director: 18922222 i Data: 01/05/99 . INSERT INTO DEPARTAMENT VALUES (6,'Personal','18922222','01/05/99'); 2) Introduir dos departaments nous, aquest vegada sense posar la data: N\u00famero: 7 ; Nom: Vendes ; Director: 18876543 . I N\u00famero: 8 ; Nom: Internacional ; Director: 18999999 . Podem posar a m\u00e9s l'ordre que vulguem: INSERT INTO DEPARTAMENT (num_d,director,nom_d) VALUES (7,'18876543','Vendes') , (8,'18999999','Internacional'); Tamb\u00e9 ho pod\u00edem haver fet aix\u00ed. Observeu que ara l'ordre ha de ser exactament el de la definici\u00f3 de la taula. INSERT INTO DEPARTAMENT VALUES (7,'Vendes','18876543',NULL) , (8,'Internacional','18999999',NULL); 3) Introduir 3 empleats en la taula EMPLEAT1 , amb els valors seg\u00fcents (la taula EMPLEAT1 la vam crear en la primera sent\u00e8ncia d'exemple de la pregunta 3.2.2, CREATE TABLE): Dni: 11111111a ; Nom: Albert Dni: 22222222b ; Nom: Berta Dni: 33333333c ; Nom: Cl\u00e0udia INSERT INTO EMPLEAT1 VALUES ('11111111a','Albert') , ('22222222b','Berta') , ('33333333c','Cl\u00e0udia') 4) Introduir 3 empleats en la taula EMPLEAT2, amb els valors seg\u00fcents (la taula EMPLEAT2 la vam crear en la segona sent\u00e8ncia d'exemple de la pregunta 3.2.2, CREATE TABLE): Dni: 44444444d ; Nom: David ; Departament: 6 ; Sou: 1000 Dni: 55555555e ; Nom: Elena ; Departament: 6 ; Sou: 1500 Dni: 66666666f ; Nom: Ferran ; Departament: 7 ; Sou: 1750 INSERT INTO EMPLEAT2 (dni,nom,departament,sou) VALUES ('44444444d ','David ',6,1000) , ('55555555e ','Elena',6,1500) , ('66666666f ','Ferran ',7,1750) 5) Suposem que tenim una taula de FACTURES en la BD proves , amb una clau principal que \u00e9s un autonum\u00e8ric ( SERIAL ). Com volem practicar \u00fanicament l'autonum\u00e8ric, la crearem senzilleta, amb la seg\u00fcent estructura: CREATE TABLE FACTURES ( num_f SERIAL PRIMARY KEY, descripcio VARCHAR, import NUMERIC ); La manera d'anar introduint normalment ser\u00e0 sense especificar num_f, per a que vaja agafant valors consecutius. INSERT INTO FACTURES (descripcio,import) VALUES ('Factura 1',54.23); Per\u00f2 si volem trencar la seq\u00fc\u00e8ncia, s\u00ed que posarem num_f. INSERT INTO FACTURES VALUES (2016001,'Factura 1 del 2016',23.98); Aix\u00f2 s\u00ed, si introdu\u00efm un altra fila sense especificar el n\u00famero de factura, l'agafar\u00e0 de la seq\u00fc\u00e8ncia, que no s'hava modificat, i per tant el valor que ens donar\u00e0 ser\u00e0 2 . INSERT INTO FACTURES (descripcio,import) VALUES ('Factura 2',36.27); Per a canviar definitivament el valor que ha d'anar autoincrementant-se, haur\u00edem de modificar la seq\u00fc\u00e8ncia ( ALTER SEQUENCE ). Despr\u00e9s de les 3 insercions anteriors, el contingut de la taula FACTURES ser\u00e0 aquest: Sintaxi per a inserci\u00f3 amb subconsulta INSERT INTO taula [ (camp1 [,camp2 [,...]]) ] SELECT ... \u00c9s a dir, les dades que van a inserir-se les traiem a partir d'una sent\u00e8ncia SELECT. La sent\u00e8ncia SELECT pot ser tan complicada com fa\u00e7a falta, i podem posar les cl\u00e0usules necess\u00e0ries: WHERE, GROUP BY, ... El requisit \u00e9s que haur\u00e0 de tornar tants camps com tinga la taula o com estiguen especificats en la sent\u00e8ncia INSERT, i que les dades que tornen siguen del mateix tipus (o tipus compatibles, encara que Access pot fer una conversi\u00f3 de tipus autom\u00e0tica). Igual que en l'anterior format, quan no s'especifique un camp se li assignar\u00e0 el valor nul, o el valor predeterminat si en t\u00e9 definit. Es podria especificar fins i tot una taula d'una base de dades externa. Consulteu la sent\u00e8ncia SELECT, l'apartat \"Especificaci\u00f3 d'una B.D. externa\". Exemples 1) Inserir tots els registres de la taula EMPLEAT1 en EMPLEAT3 , suposant que existeixen aquestes taules i encara que tenen una estructura diferent, les dues tenen els camps dni i nom . Si no existeix la taula EMPLEAT3 , pots tornar a crear-la, utilitzant l'\u00faltima sent\u00e8ncia de la pregunta 3.2.3 (Restriccions) INSERT INTO EMPLEAT3(dni,nom) SELECT dni,nom FROM EMPLEAT1; 2) Inserir en la taula EMPLEAT3 tots els empleats de la taula EMPLEAT2 dels departaments 6 i 7. INSERT INTO EMPLEAT3 SELECT * FROM EMPLEAT2 WHERE departament IN (6,7); 3) Inserir en la taula EMPLEAT3 els empleats que tenen m\u00e9s d'un familiar. Aquesta sent\u00e8ncia no la podrem executar , ja que no tenim la taula FAMILIAR . Est\u00e0 \u00fanicament de manera il\u00b7lustrativa. INSERT INTO EMPLEAT3 SELECT * FROM EMPLEAT WHERE dni IN (SELECT dni FROM FAMILIAR GROUP BY dni HAVING COUNT(*) > 1); Exercicis Com ja s'ha comentat a la introducci\u00f3, i per no interferir entre nosaltres, cadasc\u00fa es connectar\u00e0 a la seua Base de Dades f_grup_9999x (on grup \u00e9s el vostre grup p.ex. 1cfsg, 1cfsh... , 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF). L'esquema Entitat-Relaci\u00f3 i l'esquema relacional \u00e9s el seg\u00fcent: Ex_1 - Inserir en la taula CATEGORIA les seg\u00fcents files: cod_cat descripcio BjcOlimpia Components Bjc Seria Olimpia Legrand Components marca Legrand IntMagn Interruptor Magnetot\u00e9rmico Niessen Components Niesen Serie Lisa Ex_2 - Inserir els seg\u00fcents articles. cod_art descrip preu stock stock_min cod_cat B10028B Cruzamiento Bjc Serie Olimpia 4.38 2 1 BjcOlimpia B10200B Cruzamiento Bjc Olimpia Con Visor 0.88 29 BjcOlimpia L16550 Cartucho Fusible Legrand T2 250 A 5.89 1 1 Legrand L16555 Cartucho Fusible Legrand T2 315 A 5.89 3 3 Legrand IM2P10L Interruptor Magnetotermico 2p, 4 14.84 2 1 IntMagn N8008BA Base Tt Lateral Niessen Trazo Bla 4.38 6 6 Niessen Ex_3 - Inserir en la taula CLIENT tres files amb les seg\u00fcents dades cod_cli nom adreca cp cod_pob 303 MIRAVET SALA, MARIA MERCEDES URBANIZACION EL BALCO, 84-11 306 SAMPEDRO SIMO, MARIA MERCEDES FINELLO, 161 12217 387 TUR MARTIN, MANUEL FRANCISCO CALLE PEDRO VIRUELA, 108-8 12008 Ex_4 - Inserir la seg\u00fcent factura: num_f data cod_cli cod_ven iva dte 6535 2015-01-01 306 21 10 num_f num_l cod_art quant preu dte 6535 1 L16555 2 5.89 25 Ex_5 - Inserir la seg\u00fcent factura (aquesta t\u00e9 m\u00e9s d'una l\u00ednia de factura). num_f data cod_cli cod_ven iva dte 6559 2015-02-16 387 10 10 num_f num_l cod_art quant preu dte 6559 1 IM2P10L 3 14.84 6559 2 N8008BA 6 4.38 20 2.2 DELETE Aquesta sent\u00e8ncia servir\u00e0 per esborrar files senceres d'una determinada taula. Si es volen esborrar nom\u00e9s alguns camps d'una o unes determinades files, no s'ha d'utilitzar aquesta sent\u00e8ncia, sin\u00f3 que s'haur\u00e0 d'utilitzar la sent\u00e8ncia UPDATE per a posar els camps a NULL. Sintaxi DELETE FROM taula [WHERE condici\u00f3] S'esborraran les files que acomplesquen la condici\u00f3. Si no es posa el WHERE s'esborraran tetes les files de la taula (per\u00f2 no la mateixa taula, l'estructura; \u00e9s a dir, continuar\u00e0 existint la taula, per\u00f2 buida). Per la perillositat de la sent\u00e8ncia, \u00e9s convenient fer primer una sent\u00e8ncia SELECT, i quan estiguem segurs que se seleccionen nom\u00e9s les files que volem esborrar, canviar-la per DELETE. Tamb\u00e9 \u00e9s molt convenient fer c\u00f2pies de seguretat de les taules o de tota la Base de Dades. Exemples 1) Esborrar totes les files de EMPLEAT2 DELETE FROM EMPLEAT2; 2) Esborrar d' EMPLEAT3 els empleats del departament 7 DELETE FROM EMPLEAT3 WHERE departament=7; 3) Esborrar d' EMPLEAT3 els empleats majors de 47 anys (en realitat no s'esborrar\u00e0 cap perqu\u00e8 no tenim introdu\u00efda la data de naixement) DELETE FROM EMPLEAT3 WHERE EXTRACT(year FROM AGE(CURRENT_DATE,data_naixement) )>=47; 4) Esborrar d'EMPLEAT aquells empleats que trebalen en projectes menys de 20 hores (no es molt convenient confirmar l'eliminaci\u00f3 dels registres, ja que ens quedar\u00edem sense dades importants) DELETE FROM EMPLEAT WHERE dni IN (SELECT dni FROM TREBALLA GROUP BY dni HAVING SUM(hores)<20); Exercicis En f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF) Ex_6 - Esborrar la factura 6559 . Comprovar que tamb\u00e9 s'han esborrat les seues l\u00ednies de factura Ex_7 - Esborrar els articles dels quals no tenim stock m\u00ednim . 2.3 UPDATE Aquesta sent\u00e8ncia servir\u00e0 per a modificar algun o alguns camps de determinades files d'una taula. En concret tamb\u00e9 servir\u00e0 per \"esborrar\" el contingut d'algun camp d'alguna fila. El que farem ser\u00e0 posar a NULL aquest camp. Sintaxi UPDATE taula SET camp1=valor1 [ ,camp2=valor2 [,...] ] [ WHERE condici\u00f3]; Posarem per tant, despr\u00e9s d'especificar la taula, el camp (o camps) que volem canviar seguit del nou valor. En cas de voler canviar m\u00e9s d'un camp, aniran separats per comes. Nom\u00e9s canviaran els valors de les files que acomplesquen la condici\u00f3. Si no es posa condici\u00f3 es modificaran totes les files. Farem la mateixa consideraci\u00f3 de perillositat que en el DELETE: \u00e9s convenient fer primer una sent\u00e8ncia SELECT, i quan estiguem segurs que se seleccionen nom\u00e9s les files que volem modificar, canviar-la per UPDATE amb la modificaci\u00f3 dels valors. Tamb\u00e9 \u00e9s molt convenient fer c\u00f2pies de seguretat de les taules o de tota la Base de Dades. Exemples 1) Esborrar totes les dates d'incorporaci\u00f3 de la taula EMPLEAT3 UPDATE EMPLEAT3 SET data_incorporacio=NULL; 2) Augmentar el sou un 5% als empleats del departament 6 de la taula EMPLEAT3. UPDATE EMPLEAT3 SET sou = sou * 1.05 WHERE departament=6; 3) Canviar la poblaci\u00f3 a Ares i el departament al 8, a tots els empleats de Castell\u00f3 de la taula EMPLEAT3 UPDATE EMPLEAT3 SET departament=8, poblacio='Ares' WHERE poblacio='Castell\u00f3'; Exercicis En f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF) Ex_8 - Llevar tots els codis postals dels clients. Ex_9 - Pujar el preu dels articles de la categoria BjcOlimpia un 5% (el resultat ser\u00e0 que l'\u00fanic article d'aquesta categoria haur\u00e0 passat d'un preu de 4.38 a 4.60\u20ac ) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"2. Consultes d'actualitzaci\u00f3 (DML)"},{"location":"2_consultes_dactualitzaci/#2-consultes-dactualitzacio-dml","text":"","title":"2. Consultes d'actualitzaci\u00f3 (DML)"},{"location":"2_consultes_dactualitzaci/#21-insert","text":"Servir\u00e0 per a introduir noves files en una determinada taula. Hi ha dues variants d'aquesta sent\u00e8ncia. La primera servir\u00e0 per a introduir noves files proporcionant-li les dades, \u00e9s a dir, indicant expressament els nous valors dels camps. L'altra podria servir per a introduir noves files de forma m\u00e9s massiva, agafant les dades de les taules ja existents per mig d'una sent\u00e8ncia SELECT. Sintaxi per a inserci\u00f3 amb valors INSERT INTO taula [ (camp1 [,camp2 [,...]]) ] VALUES (valor1 [,valor2 [,...]]) [,(...)] Com es pot comprovar d'aquesta manera s'introduir\u00e0 una fila nova, i es proporcionen les dades directament, com a constants. Opcionalment podem introduir els valors per a una segona fila o quantes es vulguen, sempre posant les dades de cada fila entre par\u00e8ntesis, i si hi ha m\u00e9s d'una fila, separats per comes. \u00c9s opcional posar la llista de camps de la taula. Si no es posen, s'haur\u00e0 de posar un valor per a cada camp de la taula, i en el mateix ordre com estan definits en la taula. Si posem expressament els camps de la taula, els podrem posar amb l'ordre que vulguem, i no caldr\u00e0 posar-los tots. Els camps no especificats quedaran amb el valor nul (a no ser que tinguen un valor predeterminat, un valor per defecte). Per tant, haurem de posar obligat\u00f2riament tots els camps definits com a no nuls (inclosa la clau principal). Per a posar el valor nul a un camp posarem expl\u00edcitament NULL . Si tenim definit un camp autonum\u00e8ric (SERIAL) i volem continuar amb el seg\u00fcent de la seq\u00fc\u00e8ncia, no li hem de posar cap valor. Per tant en la sent\u00e8ncia SQL no haur\u00e0 de constar el camp: haurem de posar la llista de camps, i en aquest no ha d'estar el camp autonum\u00e8ric. Veurem despr\u00e9s un exemple per veure-ho m\u00e9s clar. Per contra, podem trencar la seq\u00fc\u00e8ncia posant-li un valor al camp autonum\u00e8ric, per\u00f2 aix\u00f2 no haur\u00e0 modificat la seq\u00fc\u00e8ncia. Si volem modificar-la haur\u00edem de fer-ho amb la sent\u00e8ncia ALTER SEQUENCE . Exemples 1) Introduir un departament nou amb les seg\u00fcents dades: N\u00famero: 6 ; Nom: Personal ; Director: 18922222 i Data: 01/05/99 . INSERT INTO DEPARTAMENT VALUES (6,'Personal','18922222','01/05/99'); 2) Introduir dos departaments nous, aquest vegada sense posar la data: N\u00famero: 7 ; Nom: Vendes ; Director: 18876543 . I N\u00famero: 8 ; Nom: Internacional ; Director: 18999999 . Podem posar a m\u00e9s l'ordre que vulguem: INSERT INTO DEPARTAMENT (num_d,director,nom_d) VALUES (7,'18876543','Vendes') , (8,'18999999','Internacional'); Tamb\u00e9 ho pod\u00edem haver fet aix\u00ed. Observeu que ara l'ordre ha de ser exactament el de la definici\u00f3 de la taula. INSERT INTO DEPARTAMENT VALUES (7,'Vendes','18876543',NULL) , (8,'Internacional','18999999',NULL); 3) Introduir 3 empleats en la taula EMPLEAT1 , amb els valors seg\u00fcents (la taula EMPLEAT1 la vam crear en la primera sent\u00e8ncia d'exemple de la pregunta 3.2.2, CREATE TABLE): Dni: 11111111a ; Nom: Albert Dni: 22222222b ; Nom: Berta Dni: 33333333c ; Nom: Cl\u00e0udia INSERT INTO EMPLEAT1 VALUES ('11111111a','Albert') , ('22222222b','Berta') , ('33333333c','Cl\u00e0udia') 4) Introduir 3 empleats en la taula EMPLEAT2, amb els valors seg\u00fcents (la taula EMPLEAT2 la vam crear en la segona sent\u00e8ncia d'exemple de la pregunta 3.2.2, CREATE TABLE): Dni: 44444444d ; Nom: David ; Departament: 6 ; Sou: 1000 Dni: 55555555e ; Nom: Elena ; Departament: 6 ; Sou: 1500 Dni: 66666666f ; Nom: Ferran ; Departament: 7 ; Sou: 1750 INSERT INTO EMPLEAT2 (dni,nom,departament,sou) VALUES ('44444444d ','David ',6,1000) , ('55555555e ','Elena',6,1500) , ('66666666f ','Ferran ',7,1750) 5) Suposem que tenim una taula de FACTURES en la BD proves , amb una clau principal que \u00e9s un autonum\u00e8ric ( SERIAL ). Com volem practicar \u00fanicament l'autonum\u00e8ric, la crearem senzilleta, amb la seg\u00fcent estructura: CREATE TABLE FACTURES ( num_f SERIAL PRIMARY KEY, descripcio VARCHAR, import NUMERIC ); La manera d'anar introduint normalment ser\u00e0 sense especificar num_f, per a que vaja agafant valors consecutius. INSERT INTO FACTURES (descripcio,import) VALUES ('Factura 1',54.23); Per\u00f2 si volem trencar la seq\u00fc\u00e8ncia, s\u00ed que posarem num_f. INSERT INTO FACTURES VALUES (2016001,'Factura 1 del 2016',23.98); Aix\u00f2 s\u00ed, si introdu\u00efm un altra fila sense especificar el n\u00famero de factura, l'agafar\u00e0 de la seq\u00fc\u00e8ncia, que no s'hava modificat, i per tant el valor que ens donar\u00e0 ser\u00e0 2 . INSERT INTO FACTURES (descripcio,import) VALUES ('Factura 2',36.27); Per a canviar definitivament el valor que ha d'anar autoincrementant-se, haur\u00edem de modificar la seq\u00fc\u00e8ncia ( ALTER SEQUENCE ). Despr\u00e9s de les 3 insercions anteriors, el contingut de la taula FACTURES ser\u00e0 aquest: Sintaxi per a inserci\u00f3 amb subconsulta INSERT INTO taula [ (camp1 [,camp2 [,...]]) ] SELECT ... \u00c9s a dir, les dades que van a inserir-se les traiem a partir d'una sent\u00e8ncia SELECT. La sent\u00e8ncia SELECT pot ser tan complicada com fa\u00e7a falta, i podem posar les cl\u00e0usules necess\u00e0ries: WHERE, GROUP BY, ... El requisit \u00e9s que haur\u00e0 de tornar tants camps com tinga la taula o com estiguen especificats en la sent\u00e8ncia INSERT, i que les dades que tornen siguen del mateix tipus (o tipus compatibles, encara que Access pot fer una conversi\u00f3 de tipus autom\u00e0tica). Igual que en l'anterior format, quan no s'especifique un camp se li assignar\u00e0 el valor nul, o el valor predeterminat si en t\u00e9 definit. Es podria especificar fins i tot una taula d'una base de dades externa. Consulteu la sent\u00e8ncia SELECT, l'apartat \"Especificaci\u00f3 d'una B.D. externa\". Exemples 1) Inserir tots els registres de la taula EMPLEAT1 en EMPLEAT3 , suposant que existeixen aquestes taules i encara que tenen una estructura diferent, les dues tenen els camps dni i nom . Si no existeix la taula EMPLEAT3 , pots tornar a crear-la, utilitzant l'\u00faltima sent\u00e8ncia de la pregunta 3.2.3 (Restriccions) INSERT INTO EMPLEAT3(dni,nom) SELECT dni,nom FROM EMPLEAT1; 2) Inserir en la taula EMPLEAT3 tots els empleats de la taula EMPLEAT2 dels departaments 6 i 7. INSERT INTO EMPLEAT3 SELECT * FROM EMPLEAT2 WHERE departament IN (6,7); 3) Inserir en la taula EMPLEAT3 els empleats que tenen m\u00e9s d'un familiar. Aquesta sent\u00e8ncia no la podrem executar , ja que no tenim la taula FAMILIAR . Est\u00e0 \u00fanicament de manera il\u00b7lustrativa. INSERT INTO EMPLEAT3 SELECT * FROM EMPLEAT WHERE dni IN (SELECT dni FROM FAMILIAR GROUP BY dni HAVING COUNT(*) > 1);","title":"2.1 INSERT"},{"location":"2_consultes_dactualitzaci/#exercicis","text":"Com ja s'ha comentat a la introducci\u00f3, i per no interferir entre nosaltres, cadasc\u00fa es connectar\u00e0 a la seua Base de Dades f_grup_9999x (on grup \u00e9s el vostre grup p.ex. 1cfsg, 1cfsh... , 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF). L'esquema Entitat-Relaci\u00f3 i l'esquema relacional \u00e9s el seg\u00fcent: Ex_1 - Inserir en la taula CATEGORIA les seg\u00fcents files: cod_cat descripcio BjcOlimpia Components Bjc Seria Olimpia Legrand Components marca Legrand IntMagn Interruptor Magnetot\u00e9rmico Niessen Components Niesen Serie Lisa Ex_2 - Inserir els seg\u00fcents articles. cod_art descrip preu stock stock_min cod_cat B10028B Cruzamiento Bjc Serie Olimpia 4.38 2 1 BjcOlimpia B10200B Cruzamiento Bjc Olimpia Con Visor 0.88 29 BjcOlimpia L16550 Cartucho Fusible Legrand T2 250 A 5.89 1 1 Legrand L16555 Cartucho Fusible Legrand T2 315 A 5.89 3 3 Legrand IM2P10L Interruptor Magnetotermico 2p, 4 14.84 2 1 IntMagn N8008BA Base Tt Lateral Niessen Trazo Bla 4.38 6 6 Niessen Ex_3 - Inserir en la taula CLIENT tres files amb les seg\u00fcents dades cod_cli nom adreca cp cod_pob 303 MIRAVET SALA, MARIA MERCEDES URBANIZACION EL BALCO, 84-11 306 SAMPEDRO SIMO, MARIA MERCEDES FINELLO, 161 12217 387 TUR MARTIN, MANUEL FRANCISCO CALLE PEDRO VIRUELA, 108-8 12008 Ex_4 - Inserir la seg\u00fcent factura: num_f data cod_cli cod_ven iva dte 6535 2015-01-01 306 21 10 num_f num_l cod_art quant preu dte 6535 1 L16555 2 5.89 25 Ex_5 - Inserir la seg\u00fcent factura (aquesta t\u00e9 m\u00e9s d'una l\u00ednia de factura). num_f data cod_cli cod_ven iva dte 6559 2015-02-16 387 10 10 num_f num_l cod_art quant preu dte 6559 1 IM2P10L 3 14.84 6559 2 N8008BA 6 4.38 20","title":"Exercicis"},{"location":"2_consultes_dactualitzaci/#22-delete","text":"Aquesta sent\u00e8ncia servir\u00e0 per esborrar files senceres d'una determinada taula. Si es volen esborrar nom\u00e9s alguns camps d'una o unes determinades files, no s'ha d'utilitzar aquesta sent\u00e8ncia, sin\u00f3 que s'haur\u00e0 d'utilitzar la sent\u00e8ncia UPDATE per a posar els camps a NULL. Sintaxi DELETE FROM taula [WHERE condici\u00f3] S'esborraran les files que acomplesquen la condici\u00f3. Si no es posa el WHERE s'esborraran tetes les files de la taula (per\u00f2 no la mateixa taula, l'estructura; \u00e9s a dir, continuar\u00e0 existint la taula, per\u00f2 buida). Per la perillositat de la sent\u00e8ncia, \u00e9s convenient fer primer una sent\u00e8ncia SELECT, i quan estiguem segurs que se seleccionen nom\u00e9s les files que volem esborrar, canviar-la per DELETE. Tamb\u00e9 \u00e9s molt convenient fer c\u00f2pies de seguretat de les taules o de tota la Base de Dades. Exemples 1) Esborrar totes les files de EMPLEAT2 DELETE FROM EMPLEAT2; 2) Esborrar d' EMPLEAT3 els empleats del departament 7 DELETE FROM EMPLEAT3 WHERE departament=7; 3) Esborrar d' EMPLEAT3 els empleats majors de 47 anys (en realitat no s'esborrar\u00e0 cap perqu\u00e8 no tenim introdu\u00efda la data de naixement) DELETE FROM EMPLEAT3 WHERE EXTRACT(year FROM AGE(CURRENT_DATE,data_naixement) )>=47; 4) Esborrar d'EMPLEAT aquells empleats que trebalen en projectes menys de 20 hores (no es molt convenient confirmar l'eliminaci\u00f3 dels registres, ja que ens quedar\u00edem sense dades importants) DELETE FROM EMPLEAT WHERE dni IN (SELECT dni FROM TREBALLA GROUP BY dni HAVING SUM(hores)<20);","title":"2.2 DELETE"},{"location":"2_consultes_dactualitzaci/#exercicis_1","text":"En f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF) Ex_6 - Esborrar la factura 6559 . Comprovar que tamb\u00e9 s'han esborrat les seues l\u00ednies de factura Ex_7 - Esborrar els articles dels quals no tenim stock m\u00ednim .","title":"Exercicis"},{"location":"2_consultes_dactualitzaci/#23-update","text":"Aquesta sent\u00e8ncia servir\u00e0 per a modificar algun o alguns camps de determinades files d'una taula. En concret tamb\u00e9 servir\u00e0 per \"esborrar\" el contingut d'algun camp d'alguna fila. El que farem ser\u00e0 posar a NULL aquest camp. Sintaxi UPDATE taula SET camp1=valor1 [ ,camp2=valor2 [,...] ] [ WHERE condici\u00f3]; Posarem per tant, despr\u00e9s d'especificar la taula, el camp (o camps) que volem canviar seguit del nou valor. En cas de voler canviar m\u00e9s d'un camp, aniran separats per comes. Nom\u00e9s canviaran els valors de les files que acomplesquen la condici\u00f3. Si no es posa condici\u00f3 es modificaran totes les files. Farem la mateixa consideraci\u00f3 de perillositat que en el DELETE: \u00e9s convenient fer primer una sent\u00e8ncia SELECT, i quan estiguem segurs que se seleccionen nom\u00e9s les files que volem modificar, canviar-la per UPDATE amb la modificaci\u00f3 dels valors. Tamb\u00e9 \u00e9s molt convenient fer c\u00f2pies de seguretat de les taules o de tota la Base de Dades. Exemples 1) Esborrar totes les dates d'incorporaci\u00f3 de la taula EMPLEAT3 UPDATE EMPLEAT3 SET data_incorporacio=NULL; 2) Augmentar el sou un 5% als empleats del departament 6 de la taula EMPLEAT3. UPDATE EMPLEAT3 SET sou = sou * 1.05 WHERE departament=6; 3) Canviar la poblaci\u00f3 a Ares i el departament al 8, a tots els empleats de Castell\u00f3 de la taula EMPLEAT3 UPDATE EMPLEAT3 SET departament=8, poblacio='Ares' WHERE poblacio='Castell\u00f3';","title":"2.3 UPDATE"},{"location":"2_consultes_dactualitzaci/#exercicis_2","text":"En f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF) Ex_8 - Llevar tots els codis postals dels clients. Ex_9 - Pujar el preu dels articles de la categoria BjcOlimpia un 5% (el resultat ser\u00e0 que l'\u00fanic article d'aquesta categoria haur\u00e0 passat d'un preu de 4.38 a 4.60\u20ac ) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"Exercicis"},{"location":"exercicis_de_tot_el_tema/","text":"Exercicis de tot el tema Com ja s'ha comentat a la introducci\u00f3, i per no interferir entre nosaltres, cadasc\u00fa es connectar\u00e0 a la seua Base de Dades f_grup_9999x (on grup \u00e9s el vostre grup p.ex. 1cfsg, 1cfsh... , 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF). L'esquema Entitat-Relaci\u00f3 i l'esquema relacional \u00e9s el seg\u00fcent: En la Base de Dades anomenada f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF), connectant com un usuari amb el mateix nom i contrasenya: Nota Durant tots aquestos exercicis de DML pot ser molt convenient tenir obertes les dues connexions: la de FACTURA (per anar consultant) i la de f_grup_9999x , on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF. Ex_1 - Inserir en la taula CATEGORIA les seg\u00fcents files: cod_cat descripcio BjcOlimpia Components Bjc Seria Olimpia Legrand Components marca Legrand IntMagn Interruptor Magnetot\u00e9rmico Niessen Components Niesen Serie Lisa Ex_2 - Inserir els seg\u00fcents articles. cod_art descrip preu stock stock_min cod_cat B10028B Cruzamiento Bjc Serie Olimpia 4.38 2 1 BjcOlimpia B10200B Cruzamiento Bjc Olimpia Con Visor 0.88 29 BjcOlimpia L16550 Cartucho Fusible Legrand T2 250 A 5.89 1 1 Legrand L16555 Cartucho Fusible Legrand T2 315 A 5.89 3 3 Legrand IM2P10L Interruptor Magnetotermico 2p, 4 14.84 2 1 IntMagn N8008BA Base Tt Lateral Niessen Trazo Bla 4.38 6 6 Niessen Ex_3 - Inserir en la taula CLIENT tres files amb les seg\u00fcents dades cod_cli nom adreca cp cod_pob 303 MIRAVET SALA, MARIA MERCEDES URBANIZACION EL BALCO, 84-11 306 SAMPEDRO SIMO, MARIA MERCEDES FINELLO, 161 12217 387 TUR MARTIN, MANUEL FRANCISCO CALLE PEDRO VIRUELA, 108-8 12008 Ex_4 - Inserir la seg\u00fcent factura: num_f data cod_cli cod_ven iva dte 6535 2015-01-01 306 21 10 num_f num_l cod_art quant preu dte 6535 1 L16555 2 5.89 25 Ex_5 - Inserir la seg\u00fcent factura (aquesta t\u00e9 m\u00e9s d'una l\u00ednia de factura). num_f data cod_cli cod_ven iva dte 6559 2015-02-16 387 10 10 num_f num_l cod_art quant preu dte 6559 1 IM2P10L 3 14.84 6559 2 N8008BA 6 4.38 20 Ex_6 - Esborrar la factura 6559 . Comprovar que tamb\u00e9 s'han esborrat les seues l\u00ednies de factura Ex_7 - Esborrar els articles dels quals no tenim stock m\u00ednim . Ex_8 - Llevar tots els codis postals dels clients. Ex_9 - Pujar el preu dels articles de la categoria BjcOlimpia un 5% (el resultat ser\u00e0 que l'\u00fanic article d'aquesta categoria haur\u00e0 passat d'un preu de 4.38 a 4.60\u20ac ) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"Exercicis del tot el tema"},{"location":"exercicis_de_tot_el_tema/#exercicis-de-tot-el-tema","text":"Com ja s'ha comentat a la introducci\u00f3, i per no interferir entre nosaltres, cadasc\u00fa es connectar\u00e0 a la seua Base de Dades f_grup_9999x (on grup \u00e9s el vostre grup p.ex. 1cfsg, 1cfsh... , 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF). L'esquema Entitat-Relaci\u00f3 i l'esquema relacional \u00e9s el seg\u00fcent: En la Base de Dades anomenada f_grup_9999x (on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF), connectant com un usuari amb el mateix nom i contrasenya: Nota Durant tots aquestos exercicis de DML pot ser molt convenient tenir obertes les dues connexions: la de FACTURA (per anar consultant) i la de f_grup_9999x , on grup \u00e9s el vostre grup, 9999 s\u00f3n les 4 \u00faltimes xifres del vostre DNI, i x la lletra del NIF. Ex_1 - Inserir en la taula CATEGORIA les seg\u00fcents files: cod_cat descripcio BjcOlimpia Components Bjc Seria Olimpia Legrand Components marca Legrand IntMagn Interruptor Magnetot\u00e9rmico Niessen Components Niesen Serie Lisa Ex_2 - Inserir els seg\u00fcents articles. cod_art descrip preu stock stock_min cod_cat B10028B Cruzamiento Bjc Serie Olimpia 4.38 2 1 BjcOlimpia B10200B Cruzamiento Bjc Olimpia Con Visor 0.88 29 BjcOlimpia L16550 Cartucho Fusible Legrand T2 250 A 5.89 1 1 Legrand L16555 Cartucho Fusible Legrand T2 315 A 5.89 3 3 Legrand IM2P10L Interruptor Magnetotermico 2p, 4 14.84 2 1 IntMagn N8008BA Base Tt Lateral Niessen Trazo Bla 4.38 6 6 Niessen Ex_3 - Inserir en la taula CLIENT tres files amb les seg\u00fcents dades cod_cli nom adreca cp cod_pob 303 MIRAVET SALA, MARIA MERCEDES URBANIZACION EL BALCO, 84-11 306 SAMPEDRO SIMO, MARIA MERCEDES FINELLO, 161 12217 387 TUR MARTIN, MANUEL FRANCISCO CALLE PEDRO VIRUELA, 108-8 12008 Ex_4 - Inserir la seg\u00fcent factura: num_f data cod_cli cod_ven iva dte 6535 2015-01-01 306 21 10 num_f num_l cod_art quant preu dte 6535 1 L16555 2 5.89 25 Ex_5 - Inserir la seg\u00fcent factura (aquesta t\u00e9 m\u00e9s d'una l\u00ednia de factura). num_f data cod_cli cod_ven iva dte 6559 2015-02-16 387 10 10 num_f num_l cod_art quant preu dte 6559 1 IM2P10L 3 14.84 6559 2 N8008BA 6 4.38 20 Ex_6 - Esborrar la factura 6559 . Comprovar que tamb\u00e9 s'han esborrat les seues l\u00ednies de factura Ex_7 - Esborrar els articles dels quals no tenim stock m\u00ednim . Ex_8 - Llevar tots els codis postals dels clients. Ex_9 - Pujar el preu dels articles de la categoria BjcOlimpia un 5% (el resultat ser\u00e0 que l'\u00fanic article d'aquesta categoria haur\u00e0 passat d'un preu de 4.38 a 4.60\u20ac ) Llicenciat sota la Llic\u00e8ncia Creative Commons Reconeixement NoComercial CompartirIgual 3.0","title":"Exercicis de tot el tema"}]}